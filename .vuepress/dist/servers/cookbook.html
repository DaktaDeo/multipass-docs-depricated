<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Cookbook | Multipass</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="home" href="https://forge.laravel.com">
    <link rel="apple-touch-icon" sizes="180x180" href="https://forge.laravel.com/apple-touch-icon.png">
    <link rel="icon" sizes="16x16" type="image/png" href="https://forge.laravel.com/favicon-16x16.png">
    <link rel="icon" sizes="32x32" type="image/png" href="https://forge.laravel.com/favicon-32x32.png">
    <link rel="manifest" href="https://forge.laravel.com/site.webmanifest">
    <link rel="mask-icon" href="https://forge.laravel.com/safari-pinned-tab.svg">
    <link rel="preconnect" crossorigin="true" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@200;300;400;600;800;900&amp;display=swap" rel="stylesheet">
    <meta name="description" content="">
    <meta name="msapplication-TileColor" content="#18b69b">
    <meta name="msapplication-TileImage" content="forge.laravel.com/mstile-144x144.png">
    <meta name="theme-color" content="#18b69b">
    <meta property="og:image" content="https://forge.laravel.com/social-share.png">
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:image" content="https://forge.laravel.com/social-share.png">
    <link href="https://forge.laravel.com/docs/1.0/servers/cookbook.html" rel="canonical" />
    <link rel="preload" href="/docs/assets/css/0.styles.323283b0.css" as="style"><link rel="preload" href="/docs/assets/js/app.8de603b9.js" as="script"><link rel="preload" href="/docs/assets/js/2.2427a868.js" as="script"><link rel="preload" href="/docs/assets/js/30.a802cd8a.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.583e3f4a.js"><link rel="prefetch" href="/docs/assets/js/11.e754ba34.js"><link rel="prefetch" href="/docs/assets/js/12.6fabf331.js"><link rel="prefetch" href="/docs/assets/js/13.45742f45.js"><link rel="prefetch" href="/docs/assets/js/14.9514e20b.js"><link rel="prefetch" href="/docs/assets/js/15.6e2cc6c9.js"><link rel="prefetch" href="/docs/assets/js/16.92214c79.js"><link rel="prefetch" href="/docs/assets/js/17.1c2ad899.js"><link rel="prefetch" href="/docs/assets/js/18.7324b433.js"><link rel="prefetch" href="/docs/assets/js/19.1329534e.js"><link rel="prefetch" href="/docs/assets/js/20.1bb637d5.js"><link rel="prefetch" href="/docs/assets/js/21.09157dc7.js"><link rel="prefetch" href="/docs/assets/js/22.2f037687.js"><link rel="prefetch" href="/docs/assets/js/23.01281e39.js"><link rel="prefetch" href="/docs/assets/js/24.ecd6d85c.js"><link rel="prefetch" href="/docs/assets/js/25.ab552b71.js"><link rel="prefetch" href="/docs/assets/js/26.96247722.js"><link rel="prefetch" href="/docs/assets/js/27.fae85387.js"><link rel="prefetch" href="/docs/assets/js/28.b91b591f.js"><link rel="prefetch" href="/docs/assets/js/29.4875a3ac.js"><link rel="prefetch" href="/docs/assets/js/3.ff50f703.js"><link rel="prefetch" href="/docs/assets/js/31.f840dd23.js"><link rel="prefetch" href="/docs/assets/js/32.6705dd04.js"><link rel="prefetch" href="/docs/assets/js/33.bce2ecc7.js"><link rel="prefetch" href="/docs/assets/js/34.391ca860.js"><link rel="prefetch" href="/docs/assets/js/35.898473a6.js"><link rel="prefetch" href="/docs/assets/js/36.79789b39.js"><link rel="prefetch" href="/docs/assets/js/37.5a5d496d.js"><link rel="prefetch" href="/docs/assets/js/38.d4e8375e.js"><link rel="prefetch" href="/docs/assets/js/39.61d43896.js"><link rel="prefetch" href="/docs/assets/js/4.2bc3b504.js"><link rel="prefetch" href="/docs/assets/js/40.7e22d054.js"><link rel="prefetch" href="/docs/assets/js/41.eade11b9.js"><link rel="prefetch" href="/docs/assets/js/42.58e12e1a.js"><link rel="prefetch" href="/docs/assets/js/43.1761d9d8.js"><link rel="prefetch" href="/docs/assets/js/44.2ffba445.js"><link rel="prefetch" href="/docs/assets/js/45.cb0e0222.js"><link rel="prefetch" href="/docs/assets/js/46.4d4ae784.js"><link rel="prefetch" href="/docs/assets/js/47.7bdc2583.js"><link rel="prefetch" href="/docs/assets/js/48.8623228a.js"><link rel="prefetch" href="/docs/assets/js/49.9ee05404.js"><link rel="prefetch" href="/docs/assets/js/5.23015443.js"><link rel="prefetch" href="/docs/assets/js/50.245e58a3.js"><link rel="prefetch" href="/docs/assets/js/51.5362a3cc.js"><link rel="prefetch" href="/docs/assets/js/52.f4acd629.js"><link rel="prefetch" href="/docs/assets/js/6.6ee7b8ac.js"><link rel="prefetch" href="/docs/assets/js/7.90c5b18a.js"><link rel="prefetch" href="/docs/assets/js/8.462cc10a.js"><link rel="prefetch" href="/docs/assets/js/9.2f58f023.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.323283b0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><img src="/docs/assets/img/logo.svg" alt="Multipass" class="logo"> <span class="site-name can-hide">Multipass</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://forge.laravel.com" target="_self" class="nav-link external">
  Home
  <!----></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/servers/cookbook.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  en-US
</a></li><li class="dropdown-item"><!----> <a href="/docs/nl/" class="nav-link">
  nl-BE
</a></li></ul></div></div> <a href="https://github.com/laravel/forge-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://forge.laravel.com" target="_self" class="nav-link external">
  Home
  <!----></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/servers/cookbook.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  en-US
</a></li><li class="dropdown-item"><!----> <a href="/docs/nl/" class="nav-link">
  nl-BE
</a></li></ul></div></div> <a href="https://github.com/laravel/forge-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Getting Started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/docs/cli.html" class="sidebar-link">CLI</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Accounts</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/accounts/your-account.html" class="sidebar-link">Your Account</a></li><li><a href="/docs/accounts/circles.html" class="sidebar-link">Circles</a></li><li><a href="/docs/accounts/source-control.html" class="sidebar-link">Source Control</a></li><li><a href="/docs/accounts/ssh.html" class="sidebar-link">SSH Keys</a></li><li><a href="/docs/accounts/api.html" class="sidebar-link">API</a></li><li><a href="/docs/accounts/cookbook.html" class="sidebar-link">Cookbook</a></li><li><a href="/docs/accounts/tags.html" class="sidebar-link">Tags</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Servers</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/servers/providers.html" class="sidebar-link">Server Providers</a></li><li><a href="/docs/servers/types.html" class="sidebar-link">Server Types</a></li><li><a href="/docs/servers/management.html" class="sidebar-link">Management</a></li><li><a href="/docs/servers/provisioning-process.html" class="sidebar-link">Root Access / Security</a></li><li><a href="/docs/servers/ssh.html" class="sidebar-link">SSH Keys / Git Access</a></li><li><a href="/docs/servers/php.html" class="sidebar-link">PHP</a></li><li><a href="/docs/servers/packages.html" class="sidebar-link">Packages</a></li><li><a href="/docs/servers/recipes.html" class="sidebar-link">Recipes</a></li><li><a href="/docs/servers/load-balancing.html" class="sidebar-link">Load Balancing</a></li><li><a href="/docs/servers/nginx-templates.html" class="sidebar-link">Nginx Templates</a></li><li><a href="/docs/servers/backups.html" class="sidebar-link">Database Backups</a></li><li><a href="/docs/servers/monitoring.html" class="sidebar-link">Monitoring</a></li><li><a href="/docs/servers/cookbook.html" aria-current="page" class="active sidebar-link">Cookbook</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Sites</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/sites/the-basics.html" class="sidebar-link">The Basics</a></li><li><a href="/docs/sites/deployments.html" class="sidebar-link">Deployments</a></li><li><a href="/docs/sites/commands.html" class="sidebar-link">Commands</a></li><li><a href="/docs/sites/packages.html" class="sidebar-link">Packages</a></li><li><a href="/docs/sites/queues.html" class="sidebar-link">Queues</a></li><li><a href="/docs/sites/security-rules.html" class="sidebar-link">Security Rules</a></li><li><a href="/docs/sites/redirects.html" class="sidebar-link">Redirects</a></li><li><a href="/docs/sites/ssl.html" class="sidebar-link">SSL</a></li><li><a href="/docs/sites/user-isolation.html" class="sidebar-link">User Isolation</a></li><li><a href="/docs/sites/cookbook.html" class="sidebar-link">Cookbook</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Resources</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/resources/daemons.html" class="sidebar-link">Daemons</a></li><li><a href="/docs/resources/databases.html" class="sidebar-link">Databases</a></li><li><a href="/docs/resources/caches.html" class="sidebar-link">Caches</a></li><li><a href="/docs/resources/network.html" class="sidebar-link">Network</a></li><li><a href="/docs/resources/scheduler.html" class="sidebar-link">Scheduler</a></li><li><a href="/docs/resources/integrations.html" class="sidebar-link">Integrations</a></li><li><a href="/docs/resources/cookbook.html" class="sidebar-link">Cookbook</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="cookbook"><a href="#cookbook" class="header-anchor">#</a> Cookbook</h1> <p></p><div class="table-of-contents"><ul><li><a href="#restarting-php-fpm">Restarting PHP FPM</a></li><li><a href="#resetting-the-forge-user-sudo-password">Resetting The forge User Sudo Password</a></li><li><a href="#upgrading-composer">Upgrading Composer</a></li><li><a href="#upgrading-nginx">Upgrading Nginx</a></li><li><a href="#upgrading-node-js">Upgrading Node.js</a></li><li><a href="#upgrading-npm">Upgrading npm</a></li><li><a href="#digitalocean-droplet-limit-exceeded">DigitalOcean Droplet Limit Exceeded</a></li><li><a href="#aws-provisioned-servers-are-disappearing">AWS Provisioned Servers Are Disappearing</a></li><li><a href="#server-disconnected">Server Disconnected</a></li><li><a href="#too-many-open-files-error">&quot;Too Many Open Files&quot; Error</a></li></ul></div><p></p> <h2 id="restarting-php-fpm"><a href="#restarting-php-fpm" class="header-anchor">#</a> Restarting PHP FPM</h2> <p>When configuring your server, Forge configures FPM so that it can be restarted without using your server's &quot;sudo&quot; password. To do so, you should issue the following command. Of course, you should adjust the PHP version to match the version of PHP installed on your machine:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;&quot;</span> <span class="token operator">|</span> <span class="token function">sudo</span> -S <span class="token function">service</span> php8.1-fpm reload
</code></pre></div><h2 id="resetting-the-forge-user-sudo-password"><a href="#resetting-the-forge-user-sudo-password" class="header-anchor">#</a> Resetting The <code>forge</code> User Sudo Password</h2> <p>Forge does not store your server's <code>forge</code> user sudo password and is therefore unable to reset it for you. To reset the <code>forge</code> user sudo password, you'll need to contact your server provider and regain SSH access to your server as the <code>root</code> user.</p> <p>Once you are connected to your server as the <code>root</code> user, you should run the <code>passwd forge</code> command to redefine the <code>forge</code> user sudo password.</p> <h4 id="digital-ocean"><a href="#digital-ocean" class="header-anchor">#</a> Digital Ocean</h4> <p>If your servers are managed by DigitalOcean, the following steps should assist you in resetting the <code>forge</code> user's sudo password using Digital Ocean's dashboard.</p> <ol><li><p>First, on DigitalOcean's dashboard, click on the server name. Then, within the &quot;Access&quot; tab, click on &quot;Reset Root Password&quot;. Usually, this operation restarts the server and sends the new <code>root</code> user's sudo password to your DigitalOcean account's associated email address.</p></li> <li><p>Next, still on the &quot;Access&quot; tab, click on &quot;Launch Droplet Console&quot; to gain access to your server terminal as the <code>root</code> user. During this step, you will be asked to redefine the <code>root</code> user's sudo password.</p></li> <li><p>Finally, execute the <code>passwd forge</code> terminal command as the <code>root</code> userto redefine the <code>forge</code> user's sudo password.</p></li></ol> <h2 id="upgrading-composer"><a href="#upgrading-composer" class="header-anchor">#</a> Upgrading Composer</h2> <p>The latest version of Composer is installed by Forge when a new server is provisioned. However, as your server ages, you may wish to upgrade the installed version of Composer. You may do so using the following command:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">composer</span> self-update --2
</code></pre></div><p>This will instruct Composer to update itself and specifically select version 2. If your application is not compatible with Composer 2, you can roll back to Composer 1 at any time:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">composer</span> self-update --1
</code></pre></div><h2 id="upgrading-nginx"><a href="#upgrading-nginx" class="header-anchor">#</a> Upgrading Nginx</h2> <p>The latest version of Nginx is installed by Forge when a new server is provisioned. However, as your server ages, you may wish to upgrade the installed version of Nginx. You may do so using the following commands:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y --only-upgrade nginx
<span class="token function">sudo</span> nginx -v
<span class="token function">sudo</span> <span class="token function">service</span> nginx restart
</code></pre></div><div class="custom-block danger"><p class="custom-block-title">Nginx Upgrades</p> <p>You should upgrade the Nginx version on your server at your own risk. Upgrading the version of Nginx installed on your server may cause downtime or conflict with other installed software.</p></div> <h2 id="upgrading-node-js"><a href="#upgrading-node-js" class="header-anchor">#</a> Upgrading Node.js</h2> <p>The latest version of Node.js is installed by Forge when it is provisioning a new server. However, as your server ages, you may wish to upgrade the version of Node.js:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> -fsSL https://deb.nodesource.com/setup_current.x <span class="token operator">|</span> <span class="token function">sudo</span> -E <span class="token function">bash</span> -

<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y nodejs
</code></pre></div><p><a href="https://nodejs.org/en/about/releases/" target="_self" rel="false">Node.js version information</a></p> <h2 id="upgrading-npm"><a href="#upgrading-npm" class="header-anchor">#</a> Upgrading npm</h2> <p>The latest version of npm is installed by Forge when provisioning new servers. However, you may upgrade the installed version of npm using the following commands:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">npm</span> <span class="token function">install</span> npm@latest -g
</code></pre></div><h2 id="digitalocean-droplet-limit-exceeded"><a href="#digitalocean-droplet-limit-exceeded" class="header-anchor">#</a> DigitalOcean Droplet Limit Exceeded</h2> <p>This error is returned by <a href="https://digitalocean.com" target="_self" rel="false">DigitalOcean</a> when you have reached a limit on how many droplets you can create. You can ask DigitalOcean to increase your droplet limit by contacting their support. Once they have increased your limit, you may create servers in Forge.</p> <h2 id="aws-provisioned-servers-are-disappearing"><a href="#aws-provisioned-servers-are-disappearing" class="header-anchor">#</a> AWS Provisioned Servers Are Disappearing</h2> <p>To ensure Forge works correctly with AWS, please review <a href="/docs/1.0/servers/providers.html#amazon-aws-api-access">these requirements</a>.</p> <h2 id="server-disconnected"><a href="#server-disconnected" class="header-anchor">#</a> Server Disconnected</h2> <p>There are several reasons why your server may have a &quot;disconnected&quot; status. We encourage you to check these common solutions before contacting support:</p> <ul><li>Verify that the server is powered on via your server provider's dashboard. If the server is powered off, you should restart it using your <strong>provider's dashboard</strong>.</li> <li>Verify that the public IP address of the server is known to Forge (the public IP address may change between reboots of the actual VPS).</li> <li>Verify that the Forge generated public key for the server is included in the <code>/root/.ssh/authorized_keys</code> and <code>/home/forge/.ssh/authorized_keys</code> files. This key is available via the &quot;Meta&quot; tab of your server's Forge management panel.</li> <li>If your server is behind a firewall, make sure you have <a href="/docs/1.0/introduction.html#forge-ip-addresses">allowed Forge's IP addresses to access the server</a>.</li> <li>If you removed Port 22 from the server's firewall rules, you will need to contact your server provider and ask them to restore the rule. Removing this rule prevents Forge from accessing your server via SSH.</li> <li>Remove any private keys or other lines that do not contain a valid public key from the <code>/root/.ssh/authorized_keys</code> and <code>/home/forge/.ssh/authorized_keys</code> files.</li></ul> <p>If you are still experiencing connectivity issues, you should also verify that the permissions and ownership of the following directories and files are correct:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Fixes the &quot;root&quot; user (run as root)</span>

<span class="token function">chown</span> root:root /root
<span class="token function">chown</span> -R root:root /root/.ssh
<span class="token function">chmod</span> <span class="token number">700</span> /root/.ssh
<span class="token function">chmod</span> <span class="token number">600</span> /root/.ssh/authorized_keys

<span class="token comment"># Fixes the &quot;forge&quot; user</span>

<span class="token function">chown</span> forge:forge /home/forge
<span class="token function">chown</span> -R forge:forge /home/forge/.ssh
<span class="token function">chmod</span> <span class="token number">700</span> /home/forge/.ssh
<span class="token function">chmod</span> <span class="token number">600</span> /home/forge/.ssh/authorized_keys
</code></pre></div><p>If, after trying all of the above solutions, Forge is still unable to connect to your server but you can still SSH to the server, please run the following command as the <code>root</code> user and share the output with Forge support:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">grep</span> <span class="token string">'sshd'</span> /var/log/auth.log <span class="token operator">|</span> <span class="token function">tail</span> -n <span class="token number">10</span>
</code></pre></div><div class="custom-block danger"><p class="custom-block-title">Forge Management</p> <p>If Forge is not able to connect to your server, you will not be able to manage it through the Forge dashboard until connectivity is restored.</p></div> <h2 id="too-many-open-files-error"><a href="#too-many-open-files-error" class="header-anchor">#</a> &quot;Too Many Open Files&quot; Error</h2> <p>If you are receiving an error stating that your server has &quot;too many open files&quot;, you likely need to increase the maximum amount of file descriptors that your operating system is configured to allow at a given time. This may be particularly true if your server will be handling a very large number of incoming web requests.</p> <p>First, ensure the maximum number of &quot;open files&quot; is correctly configured based on the size of your server. Usually, the maximum number of open files allowed by the operating system should be about 100 files for every 1MB of RAM. For example, if your server has 4GB memory, the maximum number of open files can safely be set to <code>409600</code>.</p> <p>You can determine how many files your operating system currently allows to be opened at once by running the <code>sysctl fs.file-max</code> command. You can configure the existing setting by adding or modifying the following line in <code>/etc/sysctl.conf</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>fs.file-max = LIMIT_HERE 
</code></pre></div><p>While the instructions above set the maximum number of &quot;open files&quot; system-wide, you also need to specify these limits for each server user by editing the <code>/etc/security/limits.conf</code> file and adding the following lines:</p> <div class="language- extra-class"><pre class="language-text"><code>root soft nofile LIMIT_HERE
root hard nofile LIMIT_HERE
forge soft nofile LIMIT_HERE
forge hard nofile LIMIT_HERE
</code></pre></div><p>Of course, if your server contains additional users due to the use of &quot;site isolation&quot;, those users also need to be added to the <code>/etc/security/limits.conf</code> file:</p> <div class="language- extra-class"><pre class="language-text"><code>isolated-user soft nofile LIMIT_HERE
isolated-user hard nofile LIMIT_HERE
</code></pre></div><p>Additionally, if the &quot;too many open files&quot; error was triggered by an Nginx process (very common on load balancers at scale), you will need to also add the <code>nginx</code> user to <code>/etc/security/limits.conf</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>nginx soft nofile LIMIT_HERE
nginx hard nofile LIMIT_HERE
</code></pre></div><p>And, add the following directive to your server's <code>/etc/nginx/nginx.conf</code> file:</p> <div class="language- extra-class"><pre class="language-text"><code>worker_rlimit_nofile LIMIT_HERE;
</code></pre></div><p>You should restart the Nginx service once this directive has been added to your Nginx configuration file:</p> <div class="language- extra-class"><pre class="language-text"><code>service nginx restart
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/laravel/forge-docs/edit/master/servers/cookbook.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/servers/monitoring.html" class="prev">
        Monitoring
      </a></span> <span class="next"><a href="/docs/sites/the-basics.html">
        The Basics
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.8de603b9.js" defer></script><script src="/docs/assets/js/2.2427a868.js" defer></script><script src="/docs/assets/js/30.a802cd8a.js" defer></script>
  </body>
</html>
